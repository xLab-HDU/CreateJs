(function (cjs, an) {

var p; // shortcut to reference prototypes
var lib={};var ss={};var img={};
lib.ssMetadata = [
		{name:"PVZ_atlas_1", frames: [[163,1353,86,36],[1324,0,350,138],[0,0,1080,600],[1676,0,350,138],[0,602,1000,600],[1527,373,110,160],[828,1293,53,84],[1811,790,56,83],[1976,1312,52,84],[571,1293,56,83],[1737,966,49,82],[1711,1318,50,83],[1539,1323,48,81],[1487,1319,50,79],[1811,1318,50,81],[1136,652,52,79],[629,1349,41,84],[1334,1032,43,83],[1201,525,103,119],[1400,373,125,143],[1324,140,201,231],[1527,140,201,231],[1082,324,165,189],[1730,357,145,167],[1877,357,145,167],[1616,1142,71,81],[1400,518,115,133],[1082,515,117,135],[1663,1318,46,91],[1325,1342,43,84],[1980,526,62,86],[771,1293,55,82],[82,1293,79,79],[1976,1233,72,77],[1002,740,96,68],[1639,461,88,62],[163,1293,95,58],[629,1293,86,54],[930,1356,100,38],[1863,1359,93,33],[1278,1298,107,42],[1032,1359,104,35],[1517,535,103,47],[1863,1318,103,39],[1946,242,94,88],[1501,1031,94,88],[1238,1032,94,88],[1737,1051,94,88],[1833,1051,94,88],[1929,1051,94,88],[1597,1052,94,88],[1002,1083,94,88],[1098,1090,94,88],[1334,1117,94,88],[1407,856,125,87],[1534,856,125,87],[1811,876,125,87],[1661,877,125,87],[1002,908,125,87],[1129,915,125,87],[1256,943,125,87],[1306,525,91,87],[1938,876,91,87],[1430,1121,91,87],[1194,1122,91,87],[1693,1141,91,87],[1786,1141,91,87],[1879,1141,91,87],[1523,1142,91,87],[1002,1173,91,87],[1095,1180,91,87],[1249,373,149,150],[1639,526,205,65],[1730,140,214,215],[1946,140,100,100],[930,1204,50,51],[401,1293,58,87],[1387,1298,50,89],[1976,1141,65,90],[1107,1269,73,88],[337,1293,62,83],[1557,1231,54,90],[1020,1269,85,85],[260,1293,75,71],[1919,614,116,84],[1383,945,116,84],[1501,945,116,84],[1788,965,116,84],[1906,965,116,84],[1619,966,116,84],[1002,997,116,84],[1120,1004,116,84],[1383,1031,116,84],[1871,702,133,85],[1136,734,133,85],[1271,741,133,85],[1406,769,133,85],[1541,769,133,85],[1871,789,133,85],[1676,790,133,85],[1002,821,133,85],[1137,828,133,85],[1272,856,133,85],[2006,700,42,87],[1233,1342,44,88],[461,1293,53,88],[1182,1299,49,90],[516,1293,53,88],[717,1293,52,89],[1279,1342,44,87],[1439,1319,46,87],[883,1293,45,87],[1693,1052,40,87],[1763,1318,46,90],[1613,1318,48,91],[0,1204,91,87],[93,1204,91,87],[186,1204,91,87],[279,1204,91,87],[372,1204,91,87],[465,1204,91,87],[558,1204,91,87],[651,1204,91,87],[744,1204,91,87],[837,1204,91,87],[1846,526,132,86],[1517,593,132,86],[1651,593,132,86],[1785,614,132,86],[1201,646,132,86],[1002,652,132,86],[1335,653,132,86],[1469,681,132,86],[1603,681,132,86],[1737,702,132,86],[1639,373,88,86],[1287,1207,88,86],[1377,1210,88,86],[1188,1211,88,86],[1616,1230,88,86],[1706,1230,88,86],[1796,1230,88,86],[1886,1230,88,86],[1467,1231,88,86],[930,1262,88,86],[0,1293,80,79],[1249,324,35,33],[1946,332,44,6],[1082,0,240,322]]}
];


(lib.AnMovieClip = function(){
	this.actionFrames = [];
	this.ignorePause = false;
	this.gotoAndPlay = function(positionOrLabel){
		cjs.MovieClip.prototype.gotoAndPlay.call(this,positionOrLabel);
	}
	this.play = function(){
		cjs.MovieClip.prototype.play.call(this);
	}
	this.gotoAndStop = function(positionOrLabel){
		cjs.MovieClip.prototype.gotoAndStop.call(this,positionOrLabel);
	}
	this.stop = function(){
		cjs.MovieClip.prototype.stop.call(this);
	}
}).prototype = p = new cjs.MovieClip();
// symbols:



(lib.阴影 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(0);
}).prototype = p = new cjs.Sprite();



(lib.youLose = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(1);
}).prototype = p = new cjs.Sprite();



(lib.游戏背景 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(2);
}).prototype = p = new cjs.Sprite();



(lib.youWin = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(3);
}).prototype = p = new cjs.Sprite();



(lib.mainMenu = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(4);
}).prototype = p = new cjs.Sprite();



(lib.cardMC = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(5);
}).prototype = p = new cjs.Sprite();



(lib.Attack1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(6);
}).prototype = p = new cjs.Sprite();



(lib.Attack1_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(7);
}).prototype = p = new cjs.Sprite();



(lib.Attack2 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(8);
}).prototype = p = new cjs.Sprite();



(lib.Attack2_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(9);
}).prototype = p = new cjs.Sprite();



(lib.Attack3 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(10);
}).prototype = p = new cjs.Sprite();



(lib.Attack3_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(11);
}).prototype = p = new cjs.Sprite();



(lib.Attack4 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(12);
}).prototype = p = new cjs.Sprite();



(lib.Attack4_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(13);
}).prototype = p = new cjs.Sprite();



(lib.Attack5 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(14);
}).prototype = p = new cjs.Sprite();



(lib.Attack5_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(15);
}).prototype = p = new cjs.Sprite();



(lib.Attack6 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(16);
}).prototype = p = new cjs.Sprite();



(lib.Attack6_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(17);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0000_Layer10 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(18);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0001_Layer9 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(19);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0002_Layer8 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(20);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0003_Layer7 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(21);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0004_Layer6 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(22);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0005_Layer5 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(23);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0006_Layer4 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(24);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0007_Layer3 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(25);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0008_Layer2 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(26);
}).prototype = p = new cjs.Sprite();



(lib.bomb_0009_Layer1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(27);
}).prototype = p = new cjs.Sprite();



(lib.Dead1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(28);
}).prototype = p = new cjs.Sprite();



(lib.Dead1_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(29);
}).prototype = p = new cjs.Sprite();



(lib.Dead2 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(30);
}).prototype = p = new cjs.Sprite();



(lib.Dead2_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(31);
}).prototype = p = new cjs.Sprite();



(lib.Dead3 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(32);
}).prototype = p = new cjs.Sprite();



(lib.Dead3_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(33);
}).prototype = p = new cjs.Sprite();



(lib.Dead4 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(34);
}).prototype = p = new cjs.Sprite();



(lib.Dead4_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(35);
}).prototype = p = new cjs.Sprite();



(lib.Dead5 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(36);
}).prototype = p = new cjs.Sprite();



(lib.Dead5_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(37);
}).prototype = p = new cjs.Sprite();



(lib.Dead6 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(38);
}).prototype = p = new cjs.Sprite();



(lib.Dead6_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(39);
}).prototype = p = new cjs.Sprite();



(lib.Dead7 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(40);
}).prototype = p = new cjs.Sprite();



(lib.Dead7_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(41);
}).prototype = p = new cjs.Sprite();



(lib.Dead8 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(42);
}).prototype = p = new cjs.Sprite();



(lib.Dead8_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(43);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(44);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(45);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(46);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(47);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(48);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(49);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(50);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(51);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(52);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_01__IDLE_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(53);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(54);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(55);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(56);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(57);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(58);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(59);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__ATTACK_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(60);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(61);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(62);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(63);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(64);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(65);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(66);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(67);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(68);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(69);
}).prototype = p = new cjs.Sprite();



(lib.Fairy_02__IDLE_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(70);
}).prototype = p = new cjs.Sprite();



(lib.menu = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(71);
}).prototype = p = new cjs.Sprite();



(lib.moneyBox = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(72);
}).prototype = p = new cjs.Sprite();



(lib.play = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(73);
}).prototype = p = new cjs.Sprite();



(lib.blockMC = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(74);
}).prototype = p = new cjs.Sprite();



(lib.remove = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(75);
}).prototype = p = new cjs.Sprite();



(lib.Run10 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(76);
}).prototype = p = new cjs.Sprite();



(lib.Run5 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(77);
}).prototype = p = new cjs.Sprite();



(lib.Run6 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(78);
}).prototype = p = new cjs.Sprite();



(lib.Run7 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(79);
}).prototype = p = new cjs.Sprite();



(lib.Run8 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(80);
}).prototype = p = new cjs.Sprite();



(lib.Run9 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(81);
}).prototype = p = new cjs.Sprite();



(lib.shield = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(82);
}).prototype = p = new cjs.Sprite();



(lib.Sun = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(83);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(84);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(85);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(86);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(87);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(88);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(89);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(90);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(91);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_IDLE_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(92);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(93);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(94);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(95);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(96);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(97);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(98);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(99);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(100);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(101);
}).prototype = p = new cjs.Sprite();



(lib.Troll_01_1_RUN_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(102);
}).prototype = p = new cjs.Sprite();



(lib.Walk1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(103);
}).prototype = p = new cjs.Sprite();



(lib.Walk1_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(104);
}).prototype = p = new cjs.Sprite();



(lib.Walk2 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(105);
}).prototype = p = new cjs.Sprite();



(lib.Walk2_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(106);
}).prototype = p = new cjs.Sprite();



(lib.Walk3 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(107);
}).prototype = p = new cjs.Sprite();



(lib.Walk3_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(108);
}).prototype = p = new cjs.Sprite();



(lib.Walk4 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(109);
}).prototype = p = new cjs.Sprite();



(lib.Walk4_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(110);
}).prototype = p = new cjs.Sprite();



(lib.Walk5 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(111);
}).prototype = p = new cjs.Sprite();



(lib.Walk5_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(112);
}).prototype = p = new cjs.Sprite();



(lib.Walk6 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(113);
}).prototype = p = new cjs.Sprite();



(lib.Walk6_1 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(114);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(115);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(116);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(117);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(118);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(119);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(120);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(121);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(122);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(123);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_01__IDLE_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(124);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(125);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(126);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(127);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(128);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(129);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(130);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(131);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(132);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(133);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__ATTACK_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(134);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_000 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(135);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_001 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(136);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_002 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(137);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_003 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(138);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_004 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(139);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_005 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(140);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_006 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(141);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_007 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(142);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_008 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(143);
}).prototype = p = new cjs.Sprite();



(lib.Warrior_03__IDLE_009 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(144);
}).prototype = p = new cjs.Sprite();



(lib.win = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(145);
}).prototype = p = new cjs.Sprite();



(lib.寒冰子弹 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(146);
}).prototype = p = new cjs.Sprite();



(lib.箭 = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(147);
}).prototype = p = new cjs.Sprite();



(lib.finishBg = function() {
	this.initialize(ss["PVZ_atlas_1"]);
	this.gotoAndStop(148);
}).prototype = p = new cjs.Sprite();
// helper functions:

function mc_symbol_clone() {
	var clone = this._cloneProps(new this.constructor(this.mode, this.startPosition, this.loop, this.reversed));
	clone.gotoAndStop(this.currentFrame);
	clone.paused = this.paused;
	clone.framerate = this.framerate;
	return clone;
}

function getMCSymbolPrototype(symbol, nominalBounds, frameBounds) {
	var prototype = cjs.extend(symbol, cjs.MovieClip);
	prototype.clone = mc_symbol_clone;
	prototype.nominalBounds = nominalBounds;
	prototype.frameBounds = frameBounds;
	return prototype;
	}


(lib.attackingZombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_3
	this.instance = new lib.Attack1_1();
	this.instance.setTransform(-16.3,4);

	this.instance_1 = new lib.Attack2_1();
	this.instance_1.setTransform(-16.3,4);

	this.instance_2 = new lib.Attack3_1();
	this.instance_2.setTransform(-10.3,4);

	this.instance_3 = new lib.Attack4_1();
	this.instance_3.setTransform(-10.3,8);

	this.instance_4 = new lib.Attack5_1();
	this.instance_4.setTransform(-12.3,8);

	this.instance_5 = new lib.Attack6_1();
	this.instance_5.setTransform(-3.3,4);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},5).to({state:[{t:this.instance_3}]},5).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},5).wait(5));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(-16.3,4,56,83);


(lib.attackingPunkZombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_2
	this.instance = new lib.Attack1();
	this.instance.setTransform(-15.05,0,1.0377,1.0375);

	this.instance_1 = new lib.Attack2();
	this.instance_1.setTransform(-14,0,1.0377,1.0375);

	this.instance_2 = new lib.Attack3();
	this.instance_2.setTransform(-10.9,2.05,1.0377,1.0375);

	this.instance_3 = new lib.Attack4();
	this.instance_3.setTransform(-9.85,3.1,1.0377,1.0375);

	this.instance_4 = new lib.Attack5();
	this.instance_4.setTransform(-11.95,3.1,1.0377,1.0375);

	this.instance_5 = new lib.Attack6();
	this.instance_5.setTransform(-2.6,0,1.0377,1.0375);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},7).to({state:[{t:this.instance_2}]},7).to({state:[{t:this.instance_3}]},7).to({state:[{t:this.instance_4}]},7).to({state:[{t:this.instance_5}]},7).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(-15,0,55,87.2);


(lib.returnBtnMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.menu();
	this.instance.setTransform(-40,-40.25,0.5369,0.5367);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.returnBtnMC, new cjs.Rectangle(-40,-40.2,80,80.5), null);


(lib.arrowMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.箭();

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.arrowMC, new cjs.Rectangle(0,0,44,6), null);


(lib.idleOrcMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Troll_01_1_IDLE_001();

	this.instance_1 = new lib.Troll_01_1_IDLE_002();

	this.instance_2 = new lib.Troll_01_1_IDLE_003();

	this.instance_3 = new lib.Troll_01_1_IDLE_004();

	this.instance_4 = new lib.Troll_01_1_IDLE_005();

	this.instance_5 = new lib.Troll_01_1_IDLE_006();

	this.instance_6 = new lib.Troll_01_1_IDLE_007();

	this.instance_7 = new lib.Troll_01_1_IDLE_008();

	this.instance_8 = new lib.Troll_01_1_IDLE_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},5).to({state:[{t:this.instance_3}]},5).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},5).to({state:[{t:this.instance_6}]},5).to({state:[{t:this.instance_7}]},5).to({state:[{t:this.instance_8}]},5).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,116,84);


(lib.removeMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.remove();
	this.instance.setTransform(-25,-25.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.removeMC, new cjs.Rectangle(-25,-25.5,50,51), null);


(lib.ShieldbearerMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_4
	this.instance = new lib.Warrior_01__IDLE_000();

	this.instance_1 = new lib.Warrior_01__IDLE_001();

	this.instance_2 = new lib.Warrior_01__IDLE_002();

	this.instance_3 = new lib.Warrior_01__IDLE_003();

	this.instance_4 = new lib.Warrior_01__IDLE_004();

	this.instance_5 = new lib.Warrior_01__IDLE_005();

	this.instance_6 = new lib.Warrior_01__IDLE_006();

	this.instance_7 = new lib.Warrior_01__IDLE_007();

	this.instance_8 = new lib.Warrior_01__IDLE_008();

	this.instance_9 = new lib.Warrior_01__IDLE_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},5).to({state:[{t:this.instance_3}]},5).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},5).to({state:[{t:this.instance_6}]},5).to({state:[{t:this.instance_7}]},5).to({state:[{t:this.instance_8}]},5).to({state:[{t:this.instance_9}]},5).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,91,87);


(lib.bombMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_2
	this.instance = new lib.bomb_0009_Layer1();
	this.instance.setTransform(-10.55,-7.3);

	this.instance_1 = new lib.bomb_0008_Layer2();
	this.instance_1.setTransform(-9.55,-6.3);

	this.instance_2 = new lib.bomb_0007_Layer3();
	this.instance_2.setTransform(12.45,19.7);

	this.instance_3 = new lib.bomb_0006_Layer4();
	this.instance_3.setTransform(-24.55,-23.3);

	this.instance_4 = new lib.bomb_0005_Layer5();
	this.instance_4.setTransform(-24.55,-23.3);

	this.instance_5 = new lib.bomb_0004_Layer6();
	this.instance_5.setTransform(-34.55,-34.3);

	this.instance_6 = new lib.bomb_0003_Layer7();
	this.instance_6.setTransform(-52.55,-55.3);

	this.instance_7 = new lib.bomb_0002_Layer8();
	this.instance_7.setTransform(-52.55,-55.3);

	this.instance_8 = new lib.bomb_0001_Layer9();
	this.instance_8.setTransform(-14.55,-11.3);

	this.instance_9 = new lib.bomb_0000_Layer10();
	this.instance_9.setTransform(-3.55,0.7);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},7).to({state:[{t:this.instance_2}]},4).to({state:[{t:this.instance_3}]},3).to({state:[{t:this.instance_4}]},3).to({state:[{t:this.instance_5}]},3).to({state:[{t:this.instance_6}]},3).to({state:[{t:this.instance_7}]},2).to({state:[{t:this.instance_8}]},2).to({state:[{t:this.instance_9}]},2).wait(2));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(-52.5,-55.3,201,231);


(lib.ShieldbearerMovingMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Warrior_01__IDLE_000();
	this.instance.setTransform(-35.5,-43.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.ShieldbearerMovingMC, new cjs.Rectangle(-35.5,-43.5,91,87), null);


(lib.bombMovingMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.bomb_0009_Layer1();
	this.instance.setTransform(-58.5,-67.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.bombMovingMC, new cjs.Rectangle(-58.5,-67.5,117,135), null);


(lib.SunfairyMovingMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Fairy_01__IDLE_000();
	this.instance.setTransform(-46,-42.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.SunfairyMovingMC, new cjs.Rectangle(-46,-42.5,94,88), null);


(lib.FrostfairyMovingMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Fairy_02__IDLE_000();
	this.instance.setTransform(-45.5,-43.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.FrostfairyMovingMC, new cjs.Rectangle(-45.5,-43.5,91,87), null);


(lib.ArcherMovingMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Warrior_03__IDLE_000();
	this.instance.setTransform(-36,-45.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.ArcherMovingMC, new cjs.Rectangle(-36,-45.5,88,86), null);


(lib.shieldMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.shield();
	this.instance.setTransform(0,4.05,1,1,-5.2486);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.shieldMC, new cjs.Rectangle(0,-3.7,92.5,92.4), null);


(lib.icebulletMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.寒冰子弹();

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.icebulletMC, new cjs.Rectangle(0,0,35,33), null);


(lib.runningOrcMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Troll_01_1_RUN_000();

	this.instance_1 = new lib.Troll_01_1_RUN_001();

	this.instance_2 = new lib.Troll_01_1_RUN_002();

	this.instance_3 = new lib.Troll_01_1_RUN_003();

	this.instance_4 = new lib.Troll_01_1_RUN_004();

	this.instance_5 = new lib.Troll_01_1_RUN_005();

	this.instance_6 = new lib.Troll_01_1_RUN_006();

	this.instance_7 = new lib.Troll_01_1_RUN_007();

	this.instance_8 = new lib.Troll_01_1_RUN_008();

	this.instance_9 = new lib.Troll_01_1_RUN_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},3).to({state:[{t:this.instance_2}]},3).to({state:[{t:this.instance_3}]},3).to({state:[{t:this.instance_4}]},3).to({state:[{t:this.instance_5}]},3).to({state:[{t:this.instance_6}]},3).to({state:[{t:this.instance_7}]},3).to({state:[{t:this.instance_8}]},3).to({state:[{t:this.instance_9}]},3).wait(3));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,133,85);


(lib.deadZombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Dead1_1();

	this.instance_1 = new lib.Dead2_1();
	this.instance_1.setTransform(0,2);

	this.instance_2 = new lib.Dead3_1();
	this.instance_2.setTransform(0,7);

	this.instance_3 = new lib.Dead4_1();
	this.instance_3.setTransform(0,22);

	this.instance_4 = new lib.Dead5_1();
	this.instance_4.setTransform(0,30);

	this.instance_5 = new lib.Dead6_1();
	this.instance_5.setTransform(0,51);

	this.instance_6 = new lib.Dead7_1();
	this.instance_6.setTransform(0,49);

	this.instance_7 = new lib.Dead8_1();
	this.instance_7.setTransform(0,45);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},3).to({state:[{t:this.instance_2}]},3).to({state:[{t:this.instance_3}]},3).to({state:[{t:this.instance_4}]},3).to({state:[{t:this.instance_5}]},3).to({state:[{t:this.instance_6}]},3).to({state:[{t:this.instance_7}]},3).wait(4));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,104,84);


(lib.deadPunkZombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Dead1();

	this.instance_1 = new lib.Dead2();
	this.instance_1.setTransform(0,5);

	this.instance_2 = new lib.Dead3();
	this.instance_2.setTransform(0,12);

	this.instance_3 = new lib.Dead4();
	this.instance_3.setTransform(0,23);

	this.instance_4 = new lib.Dead5();
	this.instance_4.setTransform(0,33);

	this.instance_5 = new lib.Dead6();
	this.instance_5.setTransform(0,53);

	this.instance_6 = new lib.Dead7();
	this.instance_6.setTransform(0,49);

	this.instance_7 = new lib.Dead8();
	this.instance_7.setTransform(0,44);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},3).to({state:[{t:this.instance_2}]},3).to({state:[{t:this.instance_3}]},3).to({state:[{t:this.instance_4}]},3).to({state:[{t:this.instance_5}]},3).to({state:[{t:this.instance_6}]},3).to({state:[{t:this.instance_7}]},3).wait(4));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,107,91);


(lib.runningPunkZombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_2
	this.instance = new lib.Run5();
	this.instance.setTransform(0,1);

	this.instance_1 = new lib.Run6();

	this.instance_2 = new lib.Run7();
	this.instance_2.setTransform(0,2);

	this.instance_3 = new lib.Run8();
	this.instance_3.setTransform(0,7);

	this.instance_4 = new lib.Run9();

	this.instance_5 = new lib.Run10();
	this.instance_5.setTransform(0,3);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},4).to({state:[{t:this.instance_3}]},4).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},7).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,73,90);


(lib.selectorMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.阴影();

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.selectorMC, new cjs.Rectangle(0,0,86,36), null);


(lib.zombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_5
	this.instance = new lib.Walk1();
	this.instance.setTransform(0,3);

	this.instance_1 = new lib.Walk2();
	this.instance_1.setTransform(0,2);

	this.instance_2 = new lib.Walk3();
	this.instance_2.setTransform(0,2);

	this.instance_3 = new lib.Walk4();
	this.instance_3.setTransform(0,3);

	this.instance_4 = new lib.Walk5();
	this.instance_4.setTransform(0,3);

	this.instance_5 = new lib.Walk6();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},7).to({state:[{t:this.instance_2}]},7).to({state:[{t:this.instance_3}]},7).to({state:[{t:this.instance_4}]},7).to({state:[{t:this.instance_5}]},7).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,53,90);


(lib.SunfairyMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_3
	this.instance = new lib.Fairy_01__IDLE_000();

	this.instance_1 = new lib.Fairy_01__IDLE_001();

	this.instance_2 = new lib.Fairy_01__IDLE_002();

	this.instance_3 = new lib.Fairy_01__IDLE_003();

	this.instance_4 = new lib.Fairy_01__IDLE_004();

	this.instance_5 = new lib.Fairy_01__IDLE_005();

	this.instance_6 = new lib.Fairy_01__IDLE_006();

	this.instance_7 = new lib.Fairy_01__IDLE_007();

	this.instance_8 = new lib.Fairy_01__IDLE_008();

	this.instance_9 = new lib.Fairy_01__IDLE_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},5).to({state:[{t:this.instance_2}]},5).to({state:[{t:this.instance_3}]},5).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},5).to({state:[{t:this.instance_6}]},5).to({state:[{t:this.instance_7}]},5).to({state:[{t:this.instance_8}]},5).to({state:[{t:this.instance_9}]},5).wait(5));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,94,88);


(lib.win_1 = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.win();

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.win_1, new cjs.Rectangle(0,0,80,79), null);


(lib.FrostfairyAttackMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Fairy_02__ATTACK_000();

	this.instance_1 = new lib.Fairy_02__ATTACK_001();

	this.instance_2 = new lib.Fairy_02__ATTACK_002();

	this.instance_3 = new lib.Fairy_02__ATTACK_003();

	this.instance_4 = new lib.Fairy_02__ATTACK_004();

	this.instance_5 = new lib.Fairy_02__ATTACK_005();

	this.instance_6 = new lib.Fairy_02__ATTACK_006();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},3).to({state:[{t:this.instance_2}]},4).to({state:[{t:this.instance_3}]},4).to({state:[{t:this.instance_4}]},3).to({state:[{t:this.instance_5}]},3).to({state:[{t:this.instance_6}]},3).wait(3));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,125,87);


(lib.ArcherAttackMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Warrior_03__ATTACK_000();

	this.instance_1 = new lib.Warrior_03__ATTACK_001();

	this.instance_2 = new lib.Warrior_03__ATTACK_002();

	this.instance_3 = new lib.Warrior_03__ATTACK_003();

	this.instance_4 = new lib.Warrior_03__ATTACK_004();

	this.instance_5 = new lib.Warrior_03__ATTACK_005();

	this.instance_6 = new lib.Warrior_03__ATTACK_006();

	this.instance_7 = new lib.Warrior_03__ATTACK_007();

	this.instance_8 = new lib.Warrior_03__ATTACK_008();

	this.instance_9 = new lib.Warrior_03__ATTACK_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},4).to({state:[{t:this.instance_3}]},4).to({state:[{t:this.instance_4}]},4).to({state:[{t:this.instance_5}]},5).to({state:[{t:this.instance_6}]},1).to({state:[{t:this.instance_7}]},1).to({state:[{t:this.instance_8}]},1).to({state:[{t:this.instance_9}]},1).wait(1));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,132,86);


(lib.startBtnMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.play();
	this.instance.setTransform(-75,-75.35,0.7009,0.7009);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(1));

	this._renderFirstFrame();

}).prototype = getMCSymbolPrototype(lib.startBtnMC, new cjs.Rectangle(-75,-75.3,150,150.7), null);


(lib.sunMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Sun();
	this.instance.setTransform(14.1,15.95);

	this.timeline.addTween(cjs.Tween.get(this.instance).wait(3).to({rotation:11.7099,x:22.1,y:9.1},0).wait(3).to({rotation:26.7078,x:34.05,y:2.9},0).wait(3).to({rotation:41.7068,x:47.25,y:0},0).wait(3));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,103.3,102.9);


(lib.FrostfairyMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.Fairy_02__IDLE_000();

	this.instance_1 = new lib.Fairy_02__IDLE_001();

	this.instance_2 = new lib.Fairy_02__IDLE_002();

	this.instance_3 = new lib.Fairy_02__IDLE_003();

	this.instance_4 = new lib.Fairy_02__IDLE_004();

	this.instance_5 = new lib.Fairy_02__IDLE_005();

	this.instance_6 = new lib.Fairy_02__IDLE_006();

	this.instance_7 = new lib.Fairy_02__IDLE_007();

	this.instance_8 = new lib.Fairy_02__IDLE_008();

	this.instance_9 = new lib.Fairy_02__IDLE_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},5).to({state:[{t:this.instance_3}]},5).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},5).to({state:[{t:this.instance_6}]},5).to({state:[{t:this.instance_7}]},5).to({state:[{t:this.instance_8}]},5).to({state:[{t:this.instance_9}]},5).wait(5));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,91,87);


(lib.punkZombieMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_2
	this.instance = new lib.Walk1_1();
	this.instance.setTransform(0,3);

	this.instance_1 = new lib.Walk2_1();
	this.instance_1.setTransform(0,1);

	this.instance_2 = new lib.Walk3_1();
	this.instance_2.setTransform(0,2);

	this.instance_3 = new lib.Walk4_1();
	this.instance_3.setTransform(0,4);

	this.instance_4 = new lib.Walk5_1();
	this.instance_4.setTransform(0,4);

	this.instance_5 = new lib.Walk6_1();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},7).to({state:[{t:this.instance_2}]},7).to({state:[{t:this.instance_3}]},7).to({state:[{t:this.instance_4}]},7).to({state:[{t:this.instance_5}]},7).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,52,91);


(lib.ArcherMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_2
	this.instance = new lib.Warrior_03__IDLE_000();

	this.instance_1 = new lib.Warrior_03__IDLE_001();

	this.instance_2 = new lib.Warrior_03__IDLE_002();

	this.instance_3 = new lib.Warrior_03__IDLE_003();

	this.instance_4 = new lib.Warrior_03__IDLE_004();

	this.instance_5 = new lib.Warrior_03__IDLE_005();

	this.instance_6 = new lib.Warrior_03__IDLE_006();

	this.instance_7 = new lib.Warrior_03__IDLE_007();

	this.instance_8 = new lib.Warrior_03__IDLE_008();

	this.instance_9 = new lib.Warrior_03__IDLE_009();

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.instance}]}).to({state:[{t:this.instance_1}]},4).to({state:[{t:this.instance_2}]},5).to({state:[{t:this.instance_3}]},5).to({state:[{t:this.instance_4}]},5).to({state:[{t:this.instance_5}]},5).to({state:[{t:this.instance_6}]},5).to({state:[{t:this.instance_7}]},5).to({state:[{t:this.instance_8}]},5).to({state:[{t:this.instance_9}]},5).wait(6));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(0,0,88,86);


(lib.winMC = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	// 图层_1
	this.instance = new lib.win_1();
	this.instance.setTransform(0,0,1,1,0,0,0,40,39.5);

	this.timeline.addTween(cjs.Tween.get(this.instance).to({scaleX:0.875,scaleY:0.8747},7).to({scaleX:1,scaleY:1},9).to({regY:39.4,scaleX:0.875,scaleY:0.8747,y:-0.1},8).to({regY:39.5,scaleX:1,scaleY:1,y:0},8).wait(1));

	this._renderFirstFrame();

}).prototype = p = new cjs.MovieClip();
p.nominalBounds = new cjs.Rectangle(-40,-39.5,80,79);


// stage content:
(lib.PVZ = function(mode,startPosition,loop,reversed) {
if (loop == null) { loop = true; }
if (reversed == null) { reversed = false; }
	var props = new Object();
	props.mode = mode;
	props.startPosition = startPosition;
	props.labels = {};
	props.loop = loop;
	props.reversed = reversed;
	cjs.MovieClip.apply(this,[props]);

	this.actionFrames = [0];
	this.isSingleFrame = false;
	// timeline functions:
	this.frame_0 = function() {
		if(this.isSingleFrame) {
			return;
		}
		if(this.totalFrames == 1) {
			this.isSingleFrame = true;
		}
		//游戏场景管理
		var mainMenuContainer = new createjs.Container(); // 主菜单容器
		var startButton; // 按钮对象，开始游戏
		var isGame = false; // 布尔变量，控制是否进入游戏逻辑
		//游戏对象数组
		var actorsArray = new Array()//能被交互角色的数组
		var zombiesArray = new Array();//出现的僵尸数组
		var actorCardsArray = new Array(); //记录所有角色卡片
		var orcsArray = new Array();//NPC兽人数组
		//容器
		var sunContainer = new cjs.Container(); //阳光容器
		var sunFromFairyContainer = new cjs.Container();  //光精灵生成阳光的容器
		var actorContainer = new cjs.Container();//角色容器
		var bulletContainer = new cjs.Container();//子弹容器
		var zombieContainer = new cjs.Container();//僵尸容器
		var orcContainer = new cjs.Container();//兽人容器
		var gridContainer = new cjs.Container();//网格容器
		var overlayContainer = new cjs.Container();//覆盖物容器
		var endMenuContainer = new cjs.Container();//界面管理容器
		//计时器
		var sunTimer = null;
		var zombieTimer = null;
		//行高和列宽
		var gridHeight = 100;
		var gridWidth = 100;
		//游戏战斗场景区域的边界
		var borderTop = 230;//左上角纵坐标
		var borderLeft = 65;//左上角横坐标
		var borderRight = 1000//右侧边界横坐标
		//其他变量
		var movingActor;// 拖动中的角色
		var selector;// 选择器
		var isMovingActor = false;//标志玩家是否在移动一个角色；@布尔变量统一加前缀is✅
		var isDragging = false;//标志玩家是否在使用铲子;@布尔变量统一加前缀is✅
		var removeButton = null;//移除按钮
		var removeButtonPos = {x:30,y:100};//移除按钮的原始坐标；@命名改成removeButtonPos✅
		
		var healthBarWidth = 55;// 血条宽度
		var healthBarHeight = 6;// 血条高度
		var totalZombies = 0;
		var killedZombies = 0;
		var maxZombies = 5;
		var money = 700;// 金钱总量
		var moneyText = new cjs.Text(money,"50px Times","#ffffff")  ;// 动态文本框，用来显示玩家的金钱
		var isSoundLoaded = false;// 音频是否加载完毕
		
		function addSound(){
			if (isSoundLoaded) return; // 防止重复加载
		    var manifest = [
				{src:"audios/bgm1.ogg", id:"bgm"},
		        {src:"audios/sound_eat.ogg", id:"eat"},
		        {src:"audios/sound_bomb.ogg", id:"bomb"},
		        {src:"audios/sound_arrow.ogg", id:"arrowShoot"},
		        {src:"audios/sound_bulletHit.ogg", id:"bulletHit"},
		        {src:"audios/orcRoar.ogg", id:"orcRoar"},
				{src:"audios/zombieGrowl.ogg", id:"zombieGrowl"},
				{src:"audios/punkZombieGrowl.ogg", id:"punkZombieGrowl"},
				{src:"audios/sunClick.ogg", id:"sunClick"},
		    ];
		    var soundQueue = new createjs.LoadQueue();
		    soundQueue.installPlugin(createjs.Sound);
		    createjs.Sound.alternateExtensions = ["ogg"];
			soundQueue.on("complete", () => {
				isSoundLoaded = true;
		        createjs.Sound.play("bgm",{ loop: -1, volume: 0.5 });
		    });
			soundQueue.loadManifest(manifest);
		}
		
		//游戏区域设置，创建用来存储角色和僵尸信息的数组
		function setupField(){
			for (var i = 0; i < 3; i++) {
				actorsArray[i]=new Array();
				zombiesArray[i]=new Array();
				for (var j=0; j<9; j++) {
					actorsArray[i][j]=0;
				}
			}
		}
		// 画出游戏区域
		function drawField(){
			drawGridBlocks();
			stage.addChild(gridContainer);
			stage.addChild(actorContainer);
			stage.addChild(zombieContainer);
			stage.addChild(orcContainer);
			stage.addChild(bulletContainer);
			stage.addChild(overlayContainer);
			stage.addChild(sunContainer);
			stage.addChild(sunFromFairyContainer);
			stage.addChild(endMenuContainer);
			overlayContainer.addChild(moneyText);
			updateMoney();
			moneyText.height = 20;
			moneyText.x = 90;
			moneyText.y = 15;
		}
		function drawGridBlocks() {
		    for (let row = 0; row < 3; row++) {
		        for (let col = 0; col < 9; col++) {
		            const block = new lib.blockMC(); 
		            block.alpha = 0.5;
		            // 位置计算，考虑间隔1像素
		            block.x = borderLeft + col * (gridWidth + 1);
		            block.y = borderTop + row * (gridHeight + 1);
		            gridContainer.addChild(block);
		        }
		    }
		}
		
		//设置铲子位置
		function addRemoveButton() {
		    var img = new Image(); // @代码直接访问素材资源生成位图对象
		    img.src = "assets/remove.png"; // #需要准备一个文件夹存储按钮图像
		
		    img.onload = function() {//@知识点preload
		        removeButton = new cjs.Bitmap(img);
		        removeButton.x = removeButtonPos.x;
		        removeButton.y = removeButtonPos.y;
		        overlayContainer.addChild(removeButton);
		        // 点击切换拖动状态，并触发删除逻辑
		        removeButton.addEventListener("click", function(evt){
		            if (!isDragging) {
		                isDragging = true;
		            } else {
		                isDragging = false;
		                removeActor();
		            }
		        });
		    };
		}
		//移除对象的逻辑
		function removeActor(){
			var actorRow=Math.floor((stage.mouseY/stage.scaleY-borderTop)/gridHeight);
			var actorCol=Math.floor((stage.mouseX/stage.scaleX-borderLeft)/gridWidth);
			if (actorRow >= 0 && actorCol >= 0 && actorRow < 3 && actorCol < 9 && actorsArray[actorRow][actorCol] == 1){
				var deletedActor = actorContainer.getChildByName("actor_"+actorRow+"_"+actorCol);
				actorContainer.removeChild(deletedActor);
				actorsArray[actorRow][actorCol] = 0;//移除角色数组中的角色
			}
		}
		
		// 更新显示阳光值
		function updateMoney(){
			moneyText.text = money.toString();
		}
		//封装生成阳光函数
		function createSun(x, y, destY, fromFairy) {//@变量赋值统一✅
			var sun = new lib.sunMC();
			sun.mouseChildren = false;
			sun.x = x;
			sun.y = y;
			sun.fromFairy = fromFairy;
			sun.addEventListener("click", sunClicked);
		
			if (fromFairy) {
				sun.rate = 100;//@修改为rate✅
				sun.recharge = 0;
				sunFromFairyContainer.addChild(sun);
			} else {
				sun.destinationY = destY;
				sunContainer.addChild(sun);
			}
			
			//阳光更新函数
			sun.update = function () {//@加入统一调度器的概念做对比
				if (this.fromFairy) {
					// 光精灵生成的阳光逻辑
					if (this.recharge == this.rate) {
						this.alpha -= 0.02;
						if (this.alpha <= 0) {
							this.removeEventListener("click", sunClicked);
							this.parent.removeChild(this);
						}
					} else {
						this.recharge++;
					}
				} else {
					// 自然生成的阳光逻辑
					if (this.y < this.destinationY) {
						this.y++;
					} else {
						this.alpha -= 0.02;
						if (this.alpha <= 0) {
							this.removeEventListener("click", sunClicked);
							this.parent.removeChild(this);
						}
					}
				}
			};
		}
		// 新增一个太阳
		function addSun(){
			sunTimer = setInterval(() => {//@1.修改前面太阳的成员变量名字；2.隐式声明的知识点；3.计时器知识点
				var sunRow = Math.floor(Math.random() * 3); // 3 行
				var sunCol = Math.floor(Math.random() * 9); // 9 列
				var x = borderLeft + sunCol * gridWidth;
				var y = 20;
				var destY = borderTop + sunRow * gridHeight;
				createSun(x, y, destY, false); // 创建阳光
			},6000);
		}
		// 点击阳光
		function sunClicked(event) {
			var sun = event.target;//@这里执行sun.mouseChildren = false;才可以
			sun.removeEventListener("click", sunClicked);
			money += 50;
			updateMoney();
		
			if (sun.fromFairy == true) {
				sunFromFairyContainer.removeChild(sun);
			} else {
				sunContainer.removeChild(sun);
			}
			createjs.Sound.play("sunClick");
		}
		
		//子弹属性EffectInfo
		const EffectInfo = {//@搜索一下概念，转盘会讲到——对象字面量
			arrow: 0,
			slowEffect: 1
		};
		//子弹信息
		const BulletConfig = {//@搜索一下概念，转盘会讲到——对象字面量
			arrow:{
				className: "arrowMC",
				damage: 20,
		        speed: 7,
				effect: EffectInfo.arrow
			},
			iceBullet:{
				className: "icebulletMC",
				damage: 15,
		        speed: 7,
				effect: EffectInfo.slowEffect
			}
		};
		//封装子弹初始化函数
		function createBullet(firingActor) {
			const bulletType = firingActor.bulletType || "normalBullet";//@语法介绍✅
			const bulletConfig = BulletConfig[bulletType];
			const bullet = new lib[bulletConfig.className]();//@知识点，可以再详细问问gpt这种写法✅
		
			bullet.damage = bulletConfig.damage;
			bullet.speed = bulletConfig.speed;
			bullet.effect = bulletConfig.effect;
		
			bullet.x = firingActor.x + firingActor.getBounds().width/2 + bullet.getBounds().width;//@定义一个变量来写✅
			bullet.y = firingActor.y + firingActor.getBounds().height/2 - bullet.getBounds().height;
			bullet.sonOf = firingActor;
		
			bulletContainer.addChild(bullet);
			createjs.Sound.play("arrowShoot",{volume: 0.2});
			// 子弹自更新逻辑
			bullet.update = function() {//@统一调度器
				this.x += this.speed;
				if (this.x > borderRight) {//@1200改为变量✅兽人部分同理共用
					this.parent.removeChild(this);
					return;
				}
				const actorRow = this.sonOf.actorRow;
				for (let j = zombieContainer.numChildren - 1; j >= 0; j--) {
					const movingZombie = zombieContainer.getChildAt(j);
					if (movingZombie.zombieRow !== actorRow) continue;
					if (movingZombie.x < this.x + this.getBounds().width/2 && movingZombie.x > this.x - this.getBounds().width) {
						movingZombie.blood -= this.damage;
						if (this.effect == EffectInfo.slowEffect) {
							movingZombie.isFrozon = true;
							movingZombie.speed = movingZombie.originalSpeed * 0.6;
							movingZombie.frozonTime = 10;
						}
						createjs.Sound.play("bulletHit");
						this.parent.removeChild(this);
						break;//@防止同时击杀多个僵尸，引入垃圾回收机制GC知识点
					}
				}
			};
		}
		
		//兽人orc信息
		const orcConfig = {
			idleOrc:{
				className: "idleOrcMC",        // 初始状态动画类名
				runningClassName: "runningOrcMC", // 触发后切换的状态
				speed: 10,
				isTriggered: false // 状态标识
			}
			//可拓展其他类型的兽人
		};
		//增加兽人orc
		function addOrc() {
			for (let row = 0; row < 3; row++) {
				const cfg = orcConfig.idleOrc;//@config可以缩写✅
		
				// 创建兽人容器
				const orc = new cjs.Container();
				let sprite = new lib[cfg.className]();//@确认一下这两行的语法✅sprite可以不用定义为属性
				orc.addChild(sprite);
				orc.orcRow = row;
				orc.blood = cfg.blood;
				orc.speed = cfg.speed;
				orc.isTriggered = false;
				orc.x = -sprite.getBounds().width / 3;
				orc.y = borderTop + row * gridHeight;
		
				// update 更新方法
				orc.update = function () {
					if (!this.isTriggered) {
						for (let i = 0; i < zombieContainer.numChildren; i++) {
							const zombie = zombieContainer.getChildAt(i);
							if (zombie.zombieRow == this.orcRow && zombie.x <= this.x + 100) {
								this.isTriggered = true;
								// 替换内部 sprite 为奔跑状态
								this.removeChild(sprite);
								sprite = new lib[orcConfig.idleOrc.runningClassName]();
								this.addChild(sprite);
								createjs.Sound.play("orcRoar");
								break;
							}
						}
					} else {
						this.x += this.speed;
						for (let i = zombieContainer.numChildren - 1; i >= 0; i--) {
							const zombie = zombieContainer.getChildAt(i);
							if (zombie.zombieRow == this.orcRow && zombie.x < this.x + 50 && zombie.x > this.x) {
								zombie.blood = 0;
							}
						}
					}
		
					// 超出边界销毁
					if (this.x > borderRight) {
						this.parent.removeChild(this);
						orcsArray[this.orcRow] = null;
					}
				};
		
				orcContainer.addChild(orc);
				orcsArray[row] = orc;
			}
		}
		
		//创建血条函数
		function createHealthBar(){
			const container = new cjs.Container();
			const bg = new cjs.Shape();
			bg.graphics.beginFill("#f00").drawRect(0, 0, healthBarWidth, healthBarHeight);
			bg.name = "bg";
		
			const bar = new cjs.Shape();
			bar.graphics.beginFill("#0f0").drawRect(0, 0, healthBarWidth, healthBarHeight);
			bar.name = "bar";
			
			container.addChild(bg, bar);
			return container;
		}
		
		//僵尸信息
		const ZombieConfig = {
			normalZombie: {
				className: "zombieMC",        // 行走僵尸精灵的链接名
				attackingClassName: "attackingZombieMC", // 进攻僵尸精灵的链接名
				deadClassName: "deadZombieMC", // 死亡僵尸精灵的链接名
				damage: 10,
				blood: 100,
				speed: 0.5,
				originalSpeed: 0.5,
				frozonTime: 0,
				isFrozon: false
			},
			punkZombie:{
				className: "punkZombieMC",
				attackingClassName: "attackingPunkZombieMC",
				deadClassName: "deadPunkZombieMC", // 死亡僵尸精灵的链接名
				runningClassName: "runningPunkZombieMC",//奔跑僵尸精灵的链接名
				damage: 10,
				blood: 150,
				speed: 0.5,
				originalSpeed: 0.5,
				frozonTime: 0,
				isFrozon: false,
				isQuick: false
			}
			//@可自行拓展其他僵尸种类
		};
		// 增加一个僵尸
		function addZombies(){
			//设置计时器
		    zombieTimer = setInterval(() => {
				if(totalZombies >= maxZombies)// @游戏结束机制/自我保护机制，防止内存溢出
				{
					clearInterval(zombieTimer);
					return;
				}
				const zombieTypes = ["normalZombie","punkZombie"];
				const randType = zombieTypes[Math.floor(Math.random() * zombieTypes.length)];
				//生成僵尸
				const zombie = createZombie(randType);
				zombieContainer.addChild(zombie);//
				zombiesArray[zombie.zombieRow].push(zombie.name);
		    }, 3000);
		}
		//封装创建僵尸函数
		function createZombie(zombieType) {
			const config = ZombieConfig[zombieType];
			const row = Math.floor(Math.random() * 3);
		
			totalZombies++;
			//主容器
			const newZombie = new cjs.Container();
			newZombie.name = "zombie_" + totalZombies;	
			// 精灵容器
			const spriteContainer = new cjs.Container();
			const movingZombie = new lib[config.className](); //创建精灵
		    const attackingZombie = new lib[config.attackingClassName]();//创建进攻僵尸精灵
		    attackingZombie.visible = false;
		    spriteContainer.addChild(movingZombie);//@加个前缀✅
		    spriteContainer.addChild(attackingZombie);  //@attacking前缀✅
		    spriteContainer.movingZombie = movingZombie;  // 添加精灵属性
		    spriteContainer.attackingZombie = attackingZombie; // 添加进攻精灵属性
		
			// 血条容器
			const healthBarContainer = createHealthBar();
			healthBarContainer.x = 0;
		
			// 添加容器
			newZombie.addChild(spriteContainer);
			newZombie.addChild(healthBarContainer);
			createjs.Sound.play("zombieGrowl");
			
			// 逻辑属性
			newZombie.spriteContainer = spriteContainer;
			newZombie.healthBarContainer = healthBarContainer;
			newZombie.zombieType = zombieType;
			newZombie.zombieRow = row;
			newZombie.damage = config.damage;
			newZombie.blood = config.blood;
			newZombie.maxHealth = config.blood;
			newZombie.speed = config.speed;
			newZombie.originalSpeed = config.speed;
			newZombie.isFrozon = config.isFrozon;
			newZombie.frozonTime = config.frozonTime;
			newZombie.isQuick = config.isQuick;
			newZombie.x = 700;
			newZombie.y = row * gridHeight + borderTop;
			
			//僵尸更新函数封装
			newZombie.update = function(){
				this.gameLose();
				this.updateHealthBar();
				this.updateFreezing();
				this.moveOrAttack();
				this.specialBehavior();// 特殊僵尸的行为函数
				//死亡判断
				if (!this.isDying && this.blood <= 0) {
					this.isDying = true;
					this.die();
				}
				if (this.isDying && this.deadZombie) {//@修改isDying的位置✅
					if (this.deadZombie.currentFrame >= this.deadZombie.totalFrames - 1) {
						this.remove();
					}
				}
			}
			//更新血条函数
			newZombie.updateHealthBar = function() {
				const bar = this.healthBarContainer.getChildByName("bar");
				const ratio = this.blood / this.maxHealth;
				bar.scaleX = Math.max(0, ratio);
			};
			//更新冰冻滤镜函数
			newZombie.updateFreezing = function(){
				if(this.isFrozon){
					this.frozonTime -= 0.1;
					var filter = new cjs.ColorMatrix().adjustColor(-10, 0, -40, 150);
					this.spriteContainer.filters = [new cjs.ColorMatrixFilter(filter)];
					this.spriteContainer.cache(-30, 0, 180, 180);
					//清除冰冻效果
					if(this.frozonTime <= 0)
					{
						this.isFrozon = false;
						this.speed = this.originalSpeed;
						this.spriteContainer.uncache();
					}
				}
			};
			//更新进攻状态函数
			newZombie.moveOrAttack = function() {
				if (this.isDying) return;// 如果僵尸已经死亡并且正在播放死亡动画，不再执行攻击和移动
				const col = Math.floor((this.x - borderLeft) / gridWidth);
				const hasActor = actorsArray[this.zombieRow][col];
				if (!hasActor) {
					this.x -= this.speed;
					this.spriteContainer.movingZombie.visible = true;//@可以改用visible属性。card.getChildByName('back').visible = false;✅
					this.spriteContainer.attackingZombie.visible = false;
				} else {
					const attackedActor = actorContainer.getChildByName("actor_"+this.zombieRow+"_"+col);
					if (attackedActor) {
						this.spriteContainer.movingZombie.visible = false;
						this.spriteContainer.attackingZombie.visible = true;
						if(this.spriteContainer.attackingZombie.currentFrame == this.spriteContainer.attackingZombie.totalFrames - 10)
						{
							attackedActor.blood -= this.damage;// 定时扣除角色血量
							createjs.Sound.play("eat");
						}
						if (attackedActor.blood <= 0) {
							actorsArray[this.zombieRow][col] = 0;
							attackedActor.parent.removeChild(attackedActor);
							this.spriteContainer.movingZombie.visible = true;
							this.spriteContainer.attackingZombie.visible = false;
						}
					}
				}
			};
			//更新朋克僵尸奔跑状态的函数
			newZombie.specialBehavior = function(){
				//如果是朋克僵尸，需要切换奔跑形态
				if(this.zombieType == "punkZombie"&& !this.isQuick && this.blood < this.maxHealth*0.6){
					this.isQuick = true;
					this.originalSpeed *= 3;
					this.speed = this.isFrozon ? this.originalSpeed * 0.6:this.originalSpeed;//根据是否处于冰冻状态更新当前速度
					//切换僵尸形态
					if (config && config.runningClassName) {
						this.spriteContainer.removeChild(this.spriteContainer.movingZombie);
						const runningZombie = new lib[config.runningClassName]();
						this.spriteContainer.movingZombie = runningZombie;
						this.spriteContainer.addChild(runningZombie);
						createjs.Sound.play("punkZombieGrowl");
					}
				}
				//@可自行拓展其他特殊事件✅
			};
			// 播放僵尸死亡动画
			newZombie.die = function() {
				// 移除原有精灵和血条
				this.spriteContainer.removeAllChildren();
				this.removeChild(healthBarContainer);
				// 创建死亡动画
				const deadZombie = new lib[ZombieConfig[this.zombieType].deadClassName]();
				deadZombie.loop = false; // 不循环
				deadZombie.gotoAndPlay(0); // 从头播放
				this.spriteContainer.addChild(deadZombie);
				this.deadZombie = deadZombie;
			};
			// 移除僵尸
			newZombie.remove = function() {
				const row = this.zombieRow;
				const name = this.name;
				const index = zombiesArray[row].indexOf(name);
				if (index !== -1) {
					zombiesArray[row].splice(index, 1);
				}
				this.parent.removeChild(this);
				killedZombies += 1;
				if (killedZombies >= maxZombies) {
					createWin(this);
				}
			};
			// 僵尸突破防线游戏失败判定
			newZombie.gameLose = function(){
				if(this.x <= 0){
					showFinishMenu();
					isGame = false;
				}
			};
			return newZombie;
		}
		
		// 创建舞台上的角色卡片
		function createActorCard(config) {
		    const card = new cjs.Container();
			const bg = new lib.cardMC();
			card.addChild(bg);	
		    card.x = borderLeft * 4 + config.num * bg.getBounds().width;
		    card.y = 5;
		    card.cost = config.cost;
		    card.movingClassName = config.movingClassName;
		    card.actorName = config.actorName;
			card.attackName = config.attackName;
		    card.fireRate = config.fireRate;
		    card.recharge = config.recharge;
		    card.bulletType = config.bulletType;
		    card.blood = config.blood;
		
		    // 角色图标（影片剪辑的一帧）
		    const actorIcon = new lib[config.actorName]();
		    actorIcon.gotoAndStop(0); // 使用第0帧
		    actorIcon.x = bg.getBounds().width / 20;
		    actorIcon.y = bg.getBounds().height / 10;
		    card.addChild(actorIcon);
		
		    // 阳光价格文字
		    const costText = new cjs.Text(config.cost, "36px Times", "#fff");
		    costText.textAlign = "center";
		    costText.x = bg.getBounds().width / 2;
		    costText.y = bg.getBounds().height * 2/3;
		    card.addChild(costText);
		
		    // 点击事件
		    card.buttonMode = true;
		    card.addEventListener("click", () => onActorClicked(card));
		
			//更新卡片可否购买函数
			card.update = function(){
		        if (money < this.cost) {
		            this.mouseEnabled = false;
		            const filter = new cjs.ColorMatrix().adjustColor(-50, -30, 0, 0);
		            this.filters = [new cjs.ColorMatrixFilter(filter)];
		            this.cache(0, 0, 180, 180);
		        } else {
		            this.mouseEnabled = true;
		            this.filters = null;
		            this.uncache();
		        }
			};
			
		    overlayContainer.addChild(card);
		    actorCardsArray.push(card);
		    //return card;
		}
		// 增加角色卡片
		function addActorsCard(){
			//射手卡片
			createActorCard({
				movingClassName: "ArcherMovingMC",// 移动的角色
				actorName: "ArcherMC",      // 部署的角色
				attackName:"ArcherAttackMC",// 攻击状态的角色
				num: 0,
				cost: 100,
				fireRate: 30,//开火频率
				recharge: 30,//填充进度
				blood: 100,
				bulletType: "arrow",
			});
			//光精灵卡片
			createActorCard({
				movingClassName: "SunfairyMovingMC",
				actorName: "SunfairyMC",
				num: 1,
				cost: 50,
				fireRate: 200,
				recharge: 0,
				blood: 50,
			}); 	
		
			//霜精灵卡片
			createActorCard({
				movingClassName: "FrostfairyMovingMC",
				actorName: "FrostfairyMC",
				attackName:"FrostfairyAttackMC",
				num: 2,
				cost: 150,
				fireRate: 30,
				recharge: 30,
				blood: 100,
				bulletType: "iceBullet",
			});
			//盾卫卡片
			createActorCard({
			movingClassName: "ShieldbearerMovingMC",
				actorName: "ShieldbearerMC",
				num: 3,
				cost: 50,
				recharge: 0,
				blood: 200,
			});
			//炸弹卡片
			createActorCard({
				movingClassName: "bombMovingMC",
				actorName: "bombMC",
				num: 4,
				cost: 150,
				blood: 99999,
			});
		}
		// 选择角色卡片
		function onActorClicked(actorCard){
			const cost = actorCard.cost;
		    const movingClass = actorCard.movingClassName;
			// 检查玩家是否有足够的钱来购买角色，并且是否正在拖动一个角色
			if (money>=cost && !isMovingActor) {
				selector = new lib.selectorMC();// 创建一个新的选择器，@改为MC大写✅
				selector.visible=false;// 使选择器不可见
				console.log("创建了一个selector!"+selector);
				overlayContainer.addChild(selector);// 把选择器加入到显示列表
				movingActor = new lib[movingClass]();// 构建一个供玩家拖动的角色
				movingActor.x=stage.mouseX/stage.scaleX;
				movingActor.y=stage.mouseY/stage.scaleY;
				movingActor.actorCard = actorCard;
				movingActor.addEventListener("click",placeActor);// 给拖动的角色注册点击事件
				overlayContainer.addChild(movingActor);//把该角色加入到显示列表
				isMovingActor=true;//告诉脚本正在移动一株角色
			}
		} 
		// 放置角色
		function placeActor(evt){
			var actorRow=Math.floor((stage.mouseY/stage.scaleY-borderTop)/gridHeight);
			var actorCol=Math.floor((stage.mouseX/stage.scaleX-borderLeft)/gridWidth);
			const actorCard = evt.currentTarget.actorCard;
			// 判断鼠标是否在有效区域内并且所在格子没有角色
			if (actorRow>=0&&actorCol>=0&&actorRow<3&&actorCol<9&&actorsArray[actorRow][actorCol]==0) {
				//部署角色的时候扣除金币
				money -= actorCard.cost;
				updateMoney();
				//创建角色
				var placedActor = createActor(actorCard,actorRow,actorCol);
				actorContainer.addChild(placedActor);
				isMovingActor=false;
				movingActor.removeEventListener("click",placeActor);
				overlayContainer.removeChild(selector);
				overlayContainer.removeChild(movingActor);
				actorsArray[actorRow][actorCol]=1;// 更新游戏区块信息
			}
			else{
				overlayContainer.removeChild(movingActor);    // 移除拖动角色
				overlayContainer.removeChild(selector);       // 移除选择器
				isMovingActor = false;                        // 重置状态
			}
		}
		//封装创建角色函数
		function createActor(actorCard,actorRow,actorCol) {
		    const placedActor = new cjs.Container();
		    placedActor.name = "actor_"+actorRow+"_"+actorCol;
		
		    // 角色容器
		    const spriteContainer = new cjs.Container();//角色容器
		    const actor = new lib[actorCard.actorName]();
			spriteContainer.actor = actor;
			spriteContainer.addChild(actor);
		
			// 血条容器
			const healthBarContainer = createHealthBar();//创建血条容器
			healthBarContainer.x = actor.getBounds().width / 4;
		
		    // 加入主容器
		    placedActor.addChild(spriteContainer, healthBarContainer);
		
		    // 属性绑定
			placedActor.sprite = actor;
			placedActor.spriteContainer = spriteContainer;
			placedActor.healthBarContainer = healthBarContainer;
			placedActor.blood = actorCard.blood;
			placedActor.maxHealth = actorCard.blood;
			placedActor.fireRate = actorCard.fireRate;
			placedActor.recharge = actorCard.recharge;
			placedActor.actorRow = actorRow;
			placedActor.actorCol = actorCol;
			placedActor.bulletType = actorCard.bulletType;
			placedActor.x = actorCol * gridWidth + borderLeft;
			placedActor.y = actorRow * gridHeight + borderTop;
			placedActor.actorName = actorCard.actorName;
			placedActor.attackName = actorCard.attackName;
			placedActor.isAttacking = false;// 是否处于发射子弹阶段
			//盾卫的额外属性
			if (actorCard.actorName == "ShieldbearerMC") {//@知识点，类似C++父类子类继承
				const shield = new lib.shieldMC();
				shield.visible = false; // 初始隐藏
				shield.x = placedActor.getBounds().width / 3;
				shield.y = 0;
				spriteContainer.addChild(shield);
				placedActor.shield = shield;
				placedActor.shield.alpha = 0;
			}
			//射手类型角色的额外属性
			var attackSprite = null;
			if (actorCard.attackName) {
				attackSprite = new lib[actorCard.attackName]();
				attackSprite.visible = false;
				placedActor.attackSprite = attackSprite;
				spriteContainer.addChild(attackSprite);
			}
			// 攻击动画控制函数（仅有攻击精灵时有效）
			placedActor.playAttack = function () {
				this.sprite.visible = false;
				this.attackSprite.visible = true;
				this.attackSprite.gotoAndPlay(0);
			};
			placedActor.playIdle = function () {
				this.attackSprite.visible = false;
				this.sprite.visible = true;
				this.sprite.gotoAndPlay(0);
			};
			
			//更新函数
			placedActor.update = function(){
				this.updateHealthBar();
				if (!this.isAttacking && this.recharge < this.fireRate) {
					this.recharge++;
				}
				if(this.actorName == "ArcherMC" || this.actorName == "FrostfairyMC" )
					this.fire();
				if(this.actorName == "SunfairyMC")
					this.createSun();
				if (this.actorName == "ShieldbearerMC")
					this.updateShield();
				if (this.actorName == "bombMC")
					this.triggerBomb();
			}
			//更新血条函数
			placedActor.updateHealthBar = function() {
				const bar = this.healthBarContainer.getChildByName("bar");
				const ratio = this.blood / this.maxHealth;
				bar.scaleX = Math.max(0, ratio);
			};
			//更新发射函数
			placedActor.fire = function () {//@用统一调度器的方式，做个实验测试内存占用差距
				//是否有敌人
				const hasEnemyAhead = zombiesArray[this.actorRow].some(zombieName => {
					const zombie = zombieContainer.getChildByName(zombieName);
					return zombie && zombie.x > this.x;
				});//.some用来判断列表中是否存在满足条件的元素，返回true或false
				switch (true) {//@优化逻辑层级结构✅
					case !this.isAttacking && hasEnemyAhead && this.recharge >= this.fireRate://①未攻击时，有敌人且填充完毕——切换攻击状态
						this.playAttack();
						this.isAttacking = true;
						break;
					case this.isAttacking && hasEnemyAhead && this.attackSprite.currentFrame >= this.attackSprite.totalFrames - 1://②攻击时，有敌人且动画完毕——切换站立状态
						createBullet(this);
						this.playIdle();
						this.isAttacking = false;
						this.recharge = 0;
						break;
					case this.isAttacking && !hasEnemyAhead:// ③攻击时，敌人清空——切换站立状态
						this.playIdle();
						this.isAttacking = false;
						this.recharge = 0;
						break;
				}
			};
		
			//更新生产阳光函数
			placedActor.createSun = function(){
				if (this.recharge >= this.fireRate-20){
						const filter = new cjs.ColorMatrix().adjustColor(10, 10, 30, 0);
						this.spriteContainer.filters = [new cjs.ColorMatrixFilter(filter)];
						this.spriteContainer.cache(0,0, 180, 180);
					} 
				if (this.recharge == this.fireRate ) {
					createSun(this.x,this.y,null,true);
					this.recharge = 0;
					this.spriteContainer.uncache();
				}
			};
			//更新盾卫护盾函数
			placedActor.updateShield = function(){
				const fadeSpeed = 0.08; // 控制护盾渐变速度
				let isAttacked = false;
				for(let i = zombiesArray[this.actorRow].length - 1; i >= 0; i--){
					const zombie = zombieContainer.getChildByName(zombiesArray[this.actorRow][i]);
					const zombieCol = Math.floor((zombie.x - borderLeft) / gridWidth);
					if(zombieCol == this.actorCol){
						isAttacked =true;
						break;
					}
				}
				if (isAttacked) {		//判断状态渐变显示护盾
					this.shield.visible = true;
					this.shield.alpha = Math.min(1, this.shield.alpha + fadeSpeed);
				} else {
					this.shield.alpha = Math.max(0, this.shield.alpha - fadeSpeed);
					if (this.shield.alpha == 0) {
						this.shield.visible = false;
					}
				}
			}
			//更新爆炸函数
			placedActor.triggerBomb = function(){
				const currentFrame = this.sprite.currentFrame;
				const totalFrames = this.sprite.totalFrames;
		
				// 1. 到倒数第10帧时触发爆炸消灭僵尸
				if (currentFrame >= totalFrames - 10) {
					createjs.Sound.play("bomb");
					// 爆炸中心 3x3 范围
					for (let i = this.actorRow - 1; i <= this.actorRow + 1; i++) {
						for (let j = this.actorCol - 1; j <= this.actorCol + 1; j++) {
							if (i >= 0 && i < 3 && j >= 0 && j < 9) {
								for (let k = zombiesArray[i].length - 1; k >= 0; k--) {
									const zombieName = zombiesArray[i][k];
									const zombie = zombieContainer.getChildByName(zombieName);
									if (!zombie) continue;
									const zombieCol = Math.floor((zombie.x - borderLeft) / gridWidth);
									if (zombieCol == j) {
										zombie.blood = 0;
									}
								}
							}
						}
					}
				}
				// 2. 动画播放结束后再移除自己
				if (currentFrame >= totalFrames - 1) {
					this.visible = false;//@先加一个不可见✅
					this.parent.removeChild(this);//@不要直接调用父容器actorContainer✅
					actorsArray[this.actorRow][this.actorCol] = 0;
				}
			};
		    return placedActor;
		}
		
		//全局管理更新
		var GameUpdater = {
			// 更新角色卡片
			updateActorCards: function () {
				for (var i = 0; i < actorCardsArray.length; i++) {
					actorCardsArray[i].update(); 
				}
			},
			// 更新角色
			updateActors: function () {
				for (var i = 0; i < actorContainer.numChildren; i++) {
					var actor = actorContainer.getChildAt(i);
					actor.update(); 
				}
			},
			// 更新子弹
			updateBullets: function () {
				for (var i = 0; i < bulletContainer.numChildren; i++) {
					var bullet = bulletContainer.getChildAt(i);
					bullet.update();
				}
			},
			// 更新僵尸
			updateZombies: function () {
				for (var i = 0; i < zombieContainer.numChildren; i++) {
					var zombie = zombieContainer.getChildAt(i);
					zombie.update(); 
				}
			},
			// 更新阳光（天空掉落 + 光精灵阳光）
			updateSuns: function () {
				// 更新下落阳光
				for (var i = 0; i < sunContainer.numChildren; i++) {
					var sun = sunContainer.getChildAt(i);
					if (sun.update) sun.update();
				}
				// 更新 fairy 阳光
				for (var i = 0; i < sunFromFairyContainer.numChildren; i++) {
					var sun = sunFromFairyContainer.getChildAt(i);
					if (sun.update) sun.update();
				}
			},
			// 更新兽人
			updateOrcs: function(){
				for(var row = 0; row < orcsArray.length; row++){
					var orc = orcsArray[row];
					if (orc) {
						orc.update();
					}
				}
			},
			// 更新拖动角色
			updateActorMoving: function() {
				if (isMovingActor) {
					movingActor.x=stage.mouseX/stage.scaleX;
					movingActor.y=stage.mouseY/stage.scaleY;
					var actorRow=Math.floor((stage.mouseY/stage.scaleY-borderTop)/gridHeight);
					var actorCol=Math.floor((stage.mouseX/stage.scaleX-borderLeft)/gridWidth);
					// 鼠标在区域内
					if (actorRow>=0&&actorCol>=0&&actorRow<3&&actorCol<9&&actorsArray[actorRow][actorCol] == 0) {
						selector.visible = true;// shows the selector
						selector.x=borderLeft+actorCol*gridWidth + 5;
						selector.y=borderTop+actorRow*gridHeight + gridHeight/2;
					} else {
						selector.visible=false;// hide the selector
					}
				}
			},
			// 更新移除按钮
			updateDeleteBtn: function(){
				if (!removeButton) return;//@保护机制
				if(isDragging){
					removeButton.x = stage.mouseX/stage.scaleX - removeButton.getBounds().width/2;
					removeButton.y = stage.mouseY/stage.scaleY - removeButton.getBounds().height/2;
				}else{
					removeButton.x = removeButtonPos.x;
					removeButton.y = removeButtonPos.y;
				}
			}
		};
		// 每帧执行的函数
		function onEnterFrm(){
			if (!isGame) return; // 主菜单状态下不执行游戏逻辑
			GameUpdater.updateActorCards();
			GameUpdater.updateActors();
			GameUpdater.updateBullets();
			GameUpdater.updateZombies();
			GameUpdater.updateSuns();
			GameUpdater.updateOrcs();
			GameUpdater.updateActorMoving();
			GameUpdater.updateDeleteBtn();
		}
		function createWin(zombie){
			const win = new lib.winMC();
			win.x = zombie.x;
			win.y = zombie.y;
			overlayContainer.addChild(win);
			win.addEventListener("click", () => {
				showFinishMenu();
				overlayContainer.removeChild(win);
			});
		}
		function showFinishMenu() {
			const menu = new cjs.Container();
			isGame = false;
			// 获取实际画布尺寸
			const canvasWidth = stage.canvas.clientWidth;
			const canvasHeight = stage.canvas.clientHeight;
		
			const bgMask = new cjs.Shape();
			bgMask.graphics.beginFill("black").drawRect(0, 0, canvasWidth, canvasHeight);
			bgMask.alpha = 0;
			bgMask.x = 0;
			bgMask.y = 0;
			endMenuContainer.addChild(bgMask);
		
			const resultBg = new lib.finishBg();
			const result = (killedZombies >= maxZombies) ? new lib.youWin() : new lib.youLose();
			result.x = (resultBg.getBounds().width - result.getBounds().width) / 2;
			result.y = 50;
		
			menu.addChild(resultBg);
			menu.addChild(result);
		
			// 添加返回主菜单按钮
			const returnBtn = new lib.returnBtnMC();
			returnBtn.x = resultBg.getBounds().width / 2;
			returnBtn.y = 250;
			returnBtn.addEventListener("click", () => {
				clearGame();
			});
			menu.addChild(returnBtn);
		
			// 计算并设置 menu 居中
			menu.x = (canvasWidth - resultBg.getBounds().width) / 2;
			menu.y = (canvasHeight - resultBg.getBounds().height) / 2;
		
			endMenuContainer.addChild(menu);
		
			createjs.Tween.get(bgMask).to({ alpha: 1 }, 500);
		}
		function createMainMenu() {
			addSound();
			const menu = new lib.mainMenu();
		    mainMenuContainer.addChild(menu);
		    startButton = new lib.startBtnMC();
		    startButton.x = stage.canvas.clientWidth / 2;
		    startButton.y = stage.canvas.clientHeight / 2 + 180;
		    mainMenuContainer.addChild(startButton);
		
		    startButton.addEventListener("click", function () {
		        stage.removeChild(mainMenuContainer);
		        startGame();
		    });
		
		    stage.addChild(mainMenuContainer);
		}
		//重置游戏
		function clearGame() {
			// 停止游戏逻辑
			isGame = false;
			createjs.Ticker.removeEventListener("tick", onEnterFrm);
		
			// 清除所有容器内容
			zombieContainer.removeAllChildren();
			bulletContainer.removeAllChildren();
			overlayContainer.removeAllChildren();
			endMenuContainer.removeAllChildren();
			sunContainer.removeAllChildren();
			sunFromFairyContainer.removeAllChildren();
			actorContainer.removeAllChildren();
			orcContainer.removeAllChildren();
			gridContainer.removeAllChildren();
			// 清空数组
			actorsArray = [];
			zombiesArray = [];
			orcsArray = [];
			actorCardsArray = [];
			//清空计时器
			clearInterval(sunTimer);
			clearInterval(zombieTimer);
			// 重置变量
			isDragging = false;
			killedZombies = 0;
			totalZombies = 0;
			money = 100;
			// 重新添加主菜单
			createMainMenu();
		}
		//创建主界面
		createMainMenu();
		//开始游戏主函数
		function startGame(){//@改函数名✅
			isGame = true;
			setupField();
			drawField();	
			addOrc();
			addRemoveButton();
			addActorsCard();
			addZombies();
			addSun();
			createjs.Ticker.addEventListener("tick", onEnterFrm);//@查一下这两句的关系
			//createjs.Ticker.addEventListener("tick", stage);
		}
	}

	// actions tween:
	this.timeline.addTween(cjs.Tween.get(this).call(this.frame_0).wait(1));

	// 背景
	this.instance = new lib.Sun();
	this.instance.setTransform(24.5,2.65,0.7264,0.7264,20.4656);

	this.instance_1 = new lib.moneyBox();
	this.instance_1.setTransform(5,5);

	this.instance_2 = new lib.游戏背景();
	this.instance_2.setTransform(-41.55,0);

	this.shape = new cjs.Shape();
	this.shape.graphics.f("#0066CC").s().p("A3tX9IAAseIp7AAMAAAgjbIZ/AAIAAP4IP9AAIAAHrIZVAAIAAMjI5VAAIAALzg");
	this.shape.setTransform(579.475,410.2);

	this.timeline.addTween(cjs.Tween.get({}).to({state:[{t:this.shape},{t:this.instance_2},{t:this.instance_1},{t:this.instance}]}).wait(1));

	this._renderFirstFrame();

}).prototype = p = new lib.AnMovieClip();
p.nominalBounds = new cjs.Rectangle(458.5,300,580,300);
// library properties:
lib.properties = {
	id: 'BE0514FBCD85E741B5DB774BC78F22EF',
	width: 1000,
	height: 600,
	fps: 30,
	color: "#FFFFFF",
	opacity: 1.00,
	manifest: [
		{src:"images/PVZ_atlas_1.png?1753771119178", id:"PVZ_atlas_1"}
	],
	preloads: []
};



// bootstrap callback support:

(lib.Stage = function(canvas) {
	createjs.Stage.call(this, canvas);
}).prototype = p = new createjs.Stage();

p.setAutoPlay = function(autoPlay) {
	this.tickEnabled = autoPlay;
}
p.play = function() { this.tickEnabled = true; this.getChildAt(0).gotoAndPlay(this.getTimelinePosition()) }
p.stop = function(ms) { if(ms) this.seek(ms); this.tickEnabled = false; }
p.seek = function(ms) { this.tickEnabled = true; this.getChildAt(0).gotoAndStop(lib.properties.fps * ms / 1000); }
p.getDuration = function() { return this.getChildAt(0).totalFrames / lib.properties.fps * 1000; }

p.getTimelinePosition = function() { return this.getChildAt(0).currentFrame / lib.properties.fps * 1000; }

an.bootcompsLoaded = an.bootcompsLoaded || [];
if(!an.bootstrapListeners) {
	an.bootstrapListeners=[];
}

an.bootstrapCallback=function(fnCallback) {
	an.bootstrapListeners.push(fnCallback);
	if(an.bootcompsLoaded.length > 0) {
		for(var i=0; i<an.bootcompsLoaded.length; ++i) {
			fnCallback(an.bootcompsLoaded[i]);
		}
	}
};

an.compositions = an.compositions || {};
an.compositions['BE0514FBCD85E741B5DB774BC78F22EF'] = {
	getStage: function() { return exportRoot.stage; },
	getLibrary: function() { return lib; },
	getSpriteSheet: function() { return ss; },
	getImages: function() { return img; }
};

an.compositionLoaded = function(id) {
	an.bootcompsLoaded.push(id);
	for(var j=0; j<an.bootstrapListeners.length; j++) {
		an.bootstrapListeners[j](id);
	}
}

an.getComposition = function(id) {
	return an.compositions[id];
}


an.makeResponsive = function(isResp, respDim, isScale, scaleType, domContainers) {		
	var lastW, lastH, lastS=1;		
	window.addEventListener('resize', resizeCanvas);		
	resizeCanvas();		
	function resizeCanvas() {			
		var w = lib.properties.width, h = lib.properties.height;			
		var iw = window.innerWidth, ih=window.innerHeight;			
		var pRatio = window.devicePixelRatio || 1, xRatio=iw/w, yRatio=ih/h, sRatio=1;			
		if(isResp) {                
			if((respDim=='width'&&lastW==iw) || (respDim=='height'&&lastH==ih)) {                    
				sRatio = lastS;                
			}				
			else if(!isScale) {					
				if(iw<w || ih<h)						
					sRatio = Math.min(xRatio, yRatio);				
			}				
			else if(scaleType==1) {					
				sRatio = Math.min(xRatio, yRatio);				
			}				
			else if(scaleType==2) {					
				sRatio = Math.max(xRatio, yRatio);				
			}			
		}
		domContainers[0].width = w * pRatio * sRatio;			
		domContainers[0].height = h * pRatio * sRatio;
		domContainers.forEach(function(container) {				
			container.style.width = w * sRatio + 'px';				
			container.style.height = h * sRatio + 'px';			
		});
		stage.scaleX = pRatio*sRatio;			
		stage.scaleY = pRatio*sRatio;
		lastW = iw; lastH = ih; lastS = sRatio;            
		stage.tickOnUpdate = false;            
		stage.update();            
		stage.tickOnUpdate = true;		
	}
}
an.handleSoundStreamOnTick = function(event) {
	if(!event.paused){
		var stageChild = stage.getChildAt(0);
		if(!stageChild.paused || stageChild.ignorePause){
			stageChild.syncStreamSounds();
		}
	}
}
an.handleFilterCache = function(event) {
	if(!event.paused){
		var target = event.target;
		if(target){
			if(target.filterCacheList){
				for(var index = 0; index < target.filterCacheList.length ; index++){
					var cacheInst = target.filterCacheList[index];
					if((cacheInst.startFrame <= target.currentFrame) && (target.currentFrame <= cacheInst.endFrame)){
						cacheInst.instance.cache(cacheInst.x, cacheInst.y, cacheInst.w, cacheInst.h);
					}
				}
			}
		}
	}
}


})(createjs = createjs||{}, AdobeAn = AdobeAn||{});
var createjs, AdobeAn;